{
  "name": "trading-compliance-v1",
  "version": "1.0.0",
  "description": "Portfolio management and trading compliance constraints",
  "constraints": [
    {
      "id": "SECTOR_LIMIT",
      "category": "Concentration Risk",
      "description": "Maximum sector exposure limit",
      "formula_readable": "rejects_trade ∨ (tech_exposure <= 40)",
      "formula": {
        "or": [
          {"==": ["rejects_trade", true]},
          {"<=": ["tech_exposure", 40]}
        ]
      },
      "variables": [
        {"name": "rejects_trade", "type": "bool"},
        {"name": "tech_exposure", "type": "real"}
      ],
      "error_message": "Technology sector exposure exceeds 40% limit",
      "citation": "Investment Policy Statement"
    },
    {
      "id": "POSITION_LIMIT",
      "category": "Position Sizing",
      "description": "Single position size limit",
      "formula_readable": "position_size <= 10",
      "formula": {"<=": ["position_size", 10]},
      "variables": [
        {"name": "position_size", "type": "real"}
      ],
      "error_message": "Single position exceeds 10% of portfolio",
      "citation": "Risk Management Guidelines"
    },
    {
      "id": "DAILY_VOLUME",
      "category": "Liquidity",
      "description": "Daily trading volume limit",
      "formula_readable": "daily_volume <= 10000000",
      "formula": {"<=": ["daily_volume", 10000000]},
      "variables": [
        {"name": "daily_volume", "type": "int"}
      ],
      "error_message": "Trade exceeds $10M daily volume limit",
      "citation": "Trading Desk Policy"
    },
    {
      "id": "CLIENT_CONSENT",
      "category": "Compliance",
      "description": "Client consent required for limit exceptions",
      "formula_readable": "rejects_trade ∨ (within_limits) ∨ (client_consent ∧ documented)",
      "formula": {
        "or": [
          {"==": ["rejects_trade", true]},
          {"==": ["within_limits", true]},
          {
            "and": [
              {"==": ["client_consent", true]},
              {"==": ["documented", true]}
            ]
          }
        ]
      },
      "variables": [
        {"name": "rejects_trade", "type": "bool"},
        {"name": "within_limits", "type": "bool"},
        {"name": "client_consent", "type": "bool"},
        {"name": "documented", "type": "bool"}
      ],
      "error_message": "Limit exception requires documented client consent",
      "citation": "SEC Fiduciary Standards"
    },
    {
      "id": "RISK_TOLERANCE",
      "category": "Suitability",
      "description": "Trade must match client risk tolerance",
      "formula_readable": "trade_risk <= client_risk_level",
      "formula": {"<=": ["trade_risk", {"var": "client_risk_level"}]},
      "variables": [
        {"name": "trade_risk", "type": "int"},
        {"name": "client_risk_level", "type": "int"}
      ],
      "error_message": "Trade exceeds client's stated risk tolerance",
      "citation": "FINRA Rule 2111"
    }
  ],
  "extractors": {
    "tech_exposure": {
      "type": "float",
      "pattern": "tech[:\\s]*(\\d+(?:\\.\\d+)?)%"
    },
    "position_size": {
      "type": "float",
      "pattern": "position[:\\s]*(\\d+(?:\\.\\d+)?)%"
    },
    "daily_volume": {
      "type": "int",
      "pattern": "\\$?([\\d,]+)(?:m|million)?"
    },
    "within_limits": {
      "type": "boolean",
      "keywords": ["within limit", "within limits", "meets all limits", "compliant with limits"]
    },
    "client_consent": {
      "type": "boolean",
      "keywords": ["consent", "authorized", "approved by client"]
    },
    "documented": {
      "type": "boolean",
      "keywords": ["documented", "recorded", "filed"]
    },
    "exceeds_limit": {
      "type": "boolean",
      "keywords": ["exceeds", "over", "above limit", "47%", "45%"]
    },
    "rejects_trade": {
      "type": "boolean",
      "keywords": ["cannot execute", "do not recommend", "recommend reducing", "recommend not", "exceeding the", "should not proceed", "rebalancing first"]
    }
  }
}
